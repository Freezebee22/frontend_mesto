(()=>{"use strict";function e(){return fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me",{headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e"}}).then((function(e){return e.json()}))}function t(e,t){t.textContent=e?"Сохранение...":"Сохранить"}fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards",{headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e"}}).then((function(e){return e.json()})).then((function(t){t.forEach((function(t){e().then((function(e){var n=e._id,o=t.likes.some((function(e){return e._id===n})),r=t.owner._id===n;c.append(T(t.name,t.link,t.likes.length,t._id,o,r))}))})),console.log(t)})),e().then((function(e){o.textContent=e.name,r.textContent=e.about,k.style.backgroundImage='url("'.concat(e.avatar,'")'),console.log(e.avatar)}));var n=document.querySelector("#card-template").content,o=document.querySelector(".profile__title"),r=document.querySelector(".profile__description"),c=document.querySelector(".places__list"),a=document.querySelector(".popup_type_edit"),i=document.querySelector(".popup_type_new-card"),u=document.querySelector(".popup_type_image"),d=document.querySelector(".popup_type_avatar"),p=document.querySelector(".profile__edit-button"),s=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__image"),_=a.querySelector(".popup__form"),f=_.querySelector(".popup__input_type_name"),m=_.querySelector(".popup__input_type_description"),v=_.querySelector(".popup__button"),y=i.querySelector(".popup__form"),h=y.querySelector(".popup__input_type_card-name"),S=y.querySelector(".popup__input_type_url"),q=y.querySelector(".popup__button"),b=u.querySelector(".popup__image"),L=u.querySelector(".popup__caption"),E=d.querySelector(".popup__form"),g=E.querySelector(".popup__input_type_url"),k=document.querySelector(".profile__image"),C=E.querySelector(".popup__button");function x(e){if("Escape"===e.key){var t=document.querySelector(".popup_is-opened");t&&w(t)}}function T(e,t,o,r){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=n.querySelector(".card").cloneNode(!0),d=i.querySelector(".card__image"),p=i.querySelector(".card__title"),s=i.querySelector(".card__like-button"),l=i.querySelector(".card__delete-button"),_=i.querySelector(".card__like__amount");return d.src=t,d.alt=e,p.textContent=e,_.textContent=o,c&&s.classList.add("card__like-button_is-active"),console.log(a),a||l.classList.add("card__delete-button_unactive"),s.addEventListener("click",(function(e){e.target.classList.toggle("card__like-button_is-active"),e.target.classList.contains("card__like-button_is-active")?(function(e){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"}})}(r),_.textContent=+_.textContent+1):(function(e){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"}})}(r),_.textContent=+_.textContent-1)})),l.addEventListener("click",(function(e){e.target.closest(".card").remove(),function(e){fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards/".concat(e),{method:"DELETE",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"}})}(r)})),d.addEventListener("click",(function(){b.src=t,b.alt=e,L.textContent=e,j(u)})),u.querySelector(".popup__close").addEventListener("click",(function(){return w(u)})),u.addEventListener("mousedown",(function(e){u.querySelector(".popup__content").contains(e.target)||w(u)})),i}function j(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",x)}function w(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",x)}a.classList.add("popup_is-animated"),i.classList.add("popup_is-animated"),u.classList.add("popup_is-animated"),d.classList.add("popup_is-animated"),p.addEventListener("click",(function(){return j(a)})),a.querySelector(".popup__close").addEventListener("click",(function(){return w(a)})),a.addEventListener("mousedown",(function(e){a.querySelector(".popup__content").contains(e.target)||w(a)})),s.addEventListener("click",(function(){return j(i)})),i.querySelector(".popup__close").addEventListener("click",(function(){return w(i)})),i.addEventListener("mousedown",(function(e){i.querySelector(".popup__content").contains(e.target)||w(i)})),l.addEventListener("click",(function(){return j(d)})),d.querySelector(".popup__close").addEventListener("click",(function(){return w(d)})),d.addEventListener("mousedown",(function(e){d.querySelector(".popup__content").contains(e.target)||w(d)})),_.addEventListener("submit",(function(e){var n,c;e.preventDefault(),t(!0,v),o.textContent=f.value,r.textContent=m.value,(n=f.value,c=m.value,fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me",{method:"PATCH",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"},body:JSON.stringify({name:n,about:c})})).then((function(e){return t(!1,v)})),w(a)})),y.addEventListener("submit",(function(e){var n,o;e.preventDefault(),t(!0,q),(n=h.value,o=S.value,fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/cards",{method:"POST",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"},body:JSON.stringify({name:n,link:o})}).then((function(e){return e.json()})).then((function(e){c.prepend(T(n,o,0,e._id))}))).then((function(e){return t(!1,q)})),w(i)})),E.addEventListener("submit",(function(e){var n;e.preventDefault(),t(!0,C),k.style.backgroundImage='url("'.concat(g.value,'")'),(n=g.value,fetch("https://nomoreparties.co/v1/frontend-st-cohort-201/users/me/avatar",{method:"PATCH",headers:{authorization:"39fdcd0c-d04b-4c8d-b2ac-1e477ca51a6e","Content-Type":"application/json"},body:JSON.stringify({avatar:n})})).then((function(e){return t(!1,C)})),w(d)}));var z=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove("button_unactive"):t.classList.add("button_unactive")};Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".popup__input")),n=e.querySelector(".button");z(t,n),t.forEach((function(o){o.addEventListener("input",(function(){z(t,n),function(e,t){t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("form__input_type_error"),n.classList.remove("form__input-error_active"),n.textContent=""}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add("form__input_type_error"),o.textContent=n,o.classList.add("form__input-error_active")}(e,t,t.validationMessage)}(e,o)}))}))}(e)}))})();